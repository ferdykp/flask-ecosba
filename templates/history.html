{% extends 'base.html' %} {% block content %}
<div class="container-fluid py-4">
  <div class="row justify-content-center">
    <div class="row">
      <div class="card w-100">
        <div class="card-header mt-2">
          <div class="w-100 w-md-auto">
            <h4 class="">Riwayat Simulasi</h4>
            <hr class="bg-success border-2 border-top border-success" />
          </div>
        </div>
        <div class="card-body">
          {% if data %} {% for item in data %}
          <div class="border rounded p-3 mb-3 bg-light position-relative">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h5 class="mb-1">
                  <strong>{{ item.nama_daerah }}</strong>
                </h5>
                <p class="mb-1">Luas Lahan: {{ item.luas_lahan }} mÂ²</p>
                <p class="mb-1 text-muted">
                  Tanggal Simulasi: {{ item.tanggal }}
                </p>
              </div>
              <div>
                <form
                  method="POST"
                  action="{{ url_for('delete', index=loop.index0) }}"
                  onsubmit="return confirm('Hapus riwayat simulasi ini?')"
                  class="d-inline-block"
                >
                  <button class="btn btn-sm btn-outline-danger">Hapus</button>
                </form>
                <button
                  class="btn btn-sm btn-outline-success"
                  data-toggle="collapse"
                  data-target="#detail-{{ loop.index }}"
                >
                  Lihat Detail
                </button>
              </div>
            </div>

            <div id="detail-{{ loop.index }}" class="collapse mt-3">
              <div class="text-center">
                <h5 class="text-success mt-4">Simulasi Penempatan Sensor</h5>
                <img
                  src="{{ url_for('static', filename=item.gambar.split('static/')[-1]) }}"
                  class="img-fluid rounded shadow"
                />
              </div>

              {% for h in item.hasil %}
              <div class="mt-4">
                <h6><strong>{{ h.label }}</strong></h6>
                <p><strong>Koordinat Sensor:</strong></p>
                <ul>
                  {% for s in h.sensor %}
                  <li>({{ s[0] }}, {{ s[1] }})</li>
                  {% endfor %}
                </ul>
                <p>
                  <strong>Area Tidak Tercakup:</strong> {{ h.tidak_tercakup }}%
                </p>
              </div>
              {% endfor %}
            </div>
          </div>
          {% endfor %} {% else %}
          <p class="text-muted text-center">Belum ada riwayat simulasi.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}
